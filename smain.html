---
layout: default
permalink: /smain
---
<div class="card">
  <div class="label">
    Please either select a topic that you need help with and start tutor matching:
  </div>
  <div>&nbsp;</div>
  <select id="selectSubject">
    <option value="0">Select one: </option>
  </select>
  <div>&nbsp;</div>
  <div><button onclick="onStartMatch();">Start Tutor Matching</button></div>
  <div>&nbsp;</div>
</div>

<script src="js/subjects.js"></script>
<script lang="javascript">
  function afterAuth() { }

  let db = firebase.firestore();

  function onStartMatch() {
    const uid = firebase.auth().currentUser.uid;
    const name = firebase.auth().currentUser.displayName;
    let val = document.getElementById("selectSubject").value;
    if (val === "0") {
      alert("Please select a topic first.");
    } else if (isEmpty(uid)) {
      alert("Please press OK to sign in first.");
      signout();
    } else {
      db.collection("asks").doc(uid).set({
        uid: uid,
        name: name,
        time: Date.now(),
        topic: val
      }).then(() => {
        alert("OK");
      }).catch((error) => {
        alert("Error requesting service, please try again: " + error);
      });
      console.log(name);
      console.log(firebase.auth().currentUser);
    }
  }

  // Initialize the drop down selections.
  let sel = document.getElementById("selectSubject");
  for (let i = 0; i < subjects.length; i++) {
    for (let j = 0; j < subjects[i].length; j++) {
      let sub = document.createElement("option");
      if (j == 0) {
        sub.innerHTML = subjects[i][0];
        sub.value = "0";
      } else {
        sub.innerHTML = " &nbsp; - " + subjects[i][j];
        sub.value = subjects[i][j];
      }
      sel.appendChild(sub);
    }
  }
</script>